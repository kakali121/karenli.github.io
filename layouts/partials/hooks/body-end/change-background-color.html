<script>
  let bg = document.getElementById('page-bg');
  bg.style.setProperty('will-change', 'filter', '');

  // Dark mode support
  let isDark = document.documentElement.classList.contains('dark');
  document.addEventListener('hbThemeChange', (e) => {
    console.debug('Theme changed - isDarkTheme? ' + e.detail.isDarkTheme());
    isDark = e.detail.isDarkTheme();
  });

  setInterval(
    function () {
      if (isDark) {
        bg.style.setProperty('filter', 'grayscale(1) brightness(1.5) invert(1) saturate(1.5)', '');
      } else {
        bg.style.setProperty('filter', 'grayscale(1) brightness(1.2)', ''); // Apply grayscale and adjust brightness for light mode
      }
    }, 100); // Small interval to detect theme changes
</script>